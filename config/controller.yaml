hybrid_force_motion_controller:
  ros__parameters:
    control_frequency_hz: 250.0
    base_link: base_link
    tool_link: p42v_link1
    joint_names: [shoulder_pan_joint, shoulder_lift_joint, elbow_joint, wrist_1_joint, wrist_2_joint, wrist_3_joint]

    search_direction: [0.0, 0.0, -1.0]
    tangential_direction_hint: [1.0, 0.0, 0.0]

    tangential_distance_m: 0.05
    tangential_gain: 1.0
    tangential_speed_mps: 0.01

    dwell_time_s: 1.0

    # Explicit force-loop gains (override legacy.normal.* if set)
    # PD(+small I) on normal force error with strong damping.
    force_kd: 5.0

    normal:
      target_N: 5.0
      # Force control (normal direction) – tuned to behave like a damped
      # impedance-style PD loop as in De Luca, slide 19.
      tolerance_N: 1.0         # force band where we consider "on target"
      kp: 0.0005               # P gain: v_n ≈ kp * (F_d - F_s)
      ki: 0.0005               # tiny integral, gated in code to |error|<=tolerance_N & in_contact
      max_velocity_mps: 0.001  # |v_n| saturation, very gentle approach/contact
      softstart_time_s: 0.7

    disengage_force_threshold_N: 2.0
    disengage_count: 30

    estimator:
      enable: true
      alpha: 0.15
      min_speed_mps: 0.001

    contact_force_min_threshold_N: 0.1

    publish_contact_frame: true
    contact_frame_id: contact_frame

cartesian_velocity_controller:
  ros__parameters:
    control_frequency_hz: 250.0
    base_link: base_link
    tool_link: p42v_link1
    joint_names: [shoulder_pan_joint, shoulder_lift_joint, elbow_joint, wrist_1_joint, wrist_2_joint, wrist_3_joint]

    velocity_limits:
      linear_mps: 0.05
      angular_radps: 0.5

    joint_velocity_limits: [0.5, 0.5, 0.5, 0.5, 0.5, 0.5]
    twist_timeout_s: 0.1
    twist_topic: /hybrid_force_motion_controller/twist_cmd
